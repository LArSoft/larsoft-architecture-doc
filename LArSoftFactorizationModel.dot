/*
 * LArSoft architecture graph for interaction between algorithms and framework
 * 
 * File:     LArSoftFactorizationModel.dot
 * Date:     November 13, 2015
 * Author:   Gianluca Petrillo (petrillo@fnal.gov)
 * Revision: 1.0
 * 
 */

digraph "LArSoft -- factorization" {
	graph [dpi=600, rankdir="TB"]
	
	subgraph cluster_framework {
		penwidth=0
		pencolor=transparent
		
		node [shape=box]
		"art framework"
		
		node [shape=ellipse]
		{
			rank=same
			"service1" [label="service"]
			"service2" [label="service"]
			
			"module1" [label="module"]
			"module2" [label="module"]
			"module3" [label="..."]
		}
	} // cluster_framework
	
	subgraph cluster {
		penwidth=0
		pencolor=transparent
		
		// rank=same
		"provider1" [label="provider"]
		"provider2" [label="provider"]
		
		"algorithm1_1" [label="algorithm"]
		"algorithm1_2" [label="algorithm"]
		"algorithm1_3" [label="algorithm"]
		
		"algorithm2_1" [label="..." shape=plaintext] // or shape=point?
	}
	
	edge [fontcolor=mediumslateblue]
	
	"art framework" -> "module1" [label="art::Event", dir=both]
	"art framework" -> "module2" [label="art::Event", dir=both]
	"art framework" -> "module3" [label="art::Event", dir=both]
	"art framework" -> "service1" [/* label="config." */]
	"art framework" -> "service2" [/* label="config." */]
	
	"service1" -> "provider1" [ /* label="owns" */ ]
	"service2" -> "provider2" [ /* label="owns" */ ]
	
	"module1" -> "algorithm1_1" [label="providers,\ndata products", dir=both]
	"module1" -> "algorithm1_2" [label="providers,\ndata products", dir=both]
	"module1" -> "algorithm1_3" [label="providers,\ndata products", dir=both]
	
	"module2" -> "algorithm2_1"
	
	"service1" -> "module1" [label="provider", color=purple]
	"service2" -> "module1" [label="provider", color=purple]
	"service1" -> "module2" [label="provider", color=purple]
	
	"provider1" -> "algorithm1_1" [label="functionality", color=orange, fontcolor=orange]
	"provider1" -> "algorithm1_2" [label="functionality", color=orange, fontcolor=orange]
	"provider2" -> "algorithm1_3" [label="functionality", color=orange, fontcolor=orange]
	
} // digraph
